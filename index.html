<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>oSec Defense Terminal</title>
  <style>
    body {
      background-color: #011627;
      color: #00ffcc;
      font-family: 'Courier New', monospace;
      padding: 20px;
      margin: 0;
    }
    #terminal {
      width: 100%;
      height: 90vh;
      overflow-y: auto;
      background-color: #011627;
      padding: 20px;
      border: none;
      outline: none;
    }
    input[type="text"] {
      background: transparent;
      border: none;
      color: #00ffcc;
      font-family: inherit;
      font-size: 16px;
      width: 90%;
    }
    #logBtn {
      margin-top: 10px;
      background-color: #00ffcc;
      color: #011627;
      border: none;
      padding: 6px 12px;
      cursor: pointer;
      font-weight: bold;
    }
    label {
      font-size: 14px;
      color: #00ffff;
    }
  </style>
</head>
<body>
  <div id="terminal">
    <div id="output">
      <pre>
Initializing oSec Defense Core...
Injecting GhostMint Engine...
Hydra LINK established ✅
<span style="color:#00ffcc">[ACCESS GRANTED]</span> Operator <b>@osecdefense</b> authenticated
Welcome to the oSec Defense Terminal.
Type <span style="color: #00ffff">'help'</span> to begin.
</pre>
    </div>
    <form onsubmit="return runCommand();">
      <span style="color:#00ffcc">x0secdefense&gt; </span><input type="text" id="cmdInput" autofocus autocomplete="off">
    </form>
  </div>
  <button id="logBtn" onclick="downloadLog()">Download Logs</button>

  <script>
    const output = document.getElementById("output");
    const input = document.getElementById("cmdInput");
    let history = [];
    let histIndex = -1;
    let balance = 3200000;

    document.addEventListener('click', () => { input.focus(); });

    input.addEventListener('keydown', function(e) {
      if (e.key === 'ArrowUp') {
        if (histIndex > 0) histIndex--;
        input.value = history[histIndex] || '';
        e.preventDefault();
      } else if (e.key === 'ArrowDown') {
        if (histIndex < history.length - 1) histIndex++;
        input.value = history[histIndex] || '';
        e.preventDefault();
      }
    });

    function runCommand() {
      const command = input.value.trim();
      if (command) {
        history.push(command);
        histIndex = history.length;
        appendTyped(`x0secdefense> ${command}\n`, () => {
          handleCommand(command);
        });
      }
      input.value = "";
      return false;
    }

    function handleCommand(command) {
      let result = "";
      switch (command.toLowerCase()) {
        case "help":
          result = `<span style="color:#00ffff">Available Commands:</span>
• help → show this menu
• balance → show earnings balance
• payout → trigger HydraChain Final
• vanish → engage stealth wipe (offline)
• reroute → re-initiate mixer logic
• status → check payout split status
• exit → shut down session`;
          break;

        case "balance":
          result = `<span style='color:#00ff88'>💰 Current Earnings Balance:</span> $${balance.toLocaleString("en-US")}.00`;
          break;

        case "payout":
  const code = prompt("🔐 Enter 4-digit operator trigger:");
  if (code === "2498") {
    result = `<span style="color:#00ff88">[🔓] Payout code verified.</span><br>[🔄] Routing HydraChain payouts...<br> → Wise Business (GBP Transfer): <b>$${(balance * 0.4).toLocaleString("en-US")}</b><br> → Cold Storage (XMR via Mixer): <b>$${(balance * 0.6).toLocaleString("en-US")}</b><br><span style="color:#00ff88">[✅] Routing instructions complete.</span>`;
    balance = 0;

    // LIVE CALL TO BACKEND
    fetch("https://x0sec-admin.onrender.com/trigger_payout?code=2498", {
      method: "POST"
    })
    .then(response => response.json())
    .then(data => {
      console.log("[Hydra Admin] LIVE payout backend hit:", data);
    })
    .catch(error => {
      console.error("[Hydra Admin] LIVE backend error:", error);
    });

  } else {
    result = "<span style='color:#ff4444'>[❌] Invalid trigger. Access denied.</span>";
  }
  break;


        case "status":
          result = "Split Config: <span style='color:#00ffff'>40%</span> Wise GBP • <span style='color:#00ffff'>60%</span> Cold Storage (XMR)";
          break;

        case "vanish":
          result = "<span style='color:#ff0077'>[🧼] VANISH Protocol armed. Logs wiping...</span>";
          // Optional: Add log clearing logic
          break;

        case "reroute":
          result = "[🔄] Mixer logic reinitialized. Stealth circuits online.";
          break;

        case "exit":
          result = "<span style='color:#888888'>[🔒] Session terminated. Goodbye, Operator.</span>";
          break;

        default:
          result = `<span style='color:#ff4444'>[ERROR]</span> Unknown command: '${command}' — try '<span style="color:#00ffff">help</span>'`;
      }
      appendTyped(result + "\n\n");
    }

    function appendTyped(text, callback) {
      let i = 0;
      const interval = setInterval(() => {
        if (i < text.length) {
          output.innerHTML += text.charAt(i);
          output.scrollTop = output.scrollHeight;
          i++;
        } else {
          clearInterval(interval);
          if (callback) callback();
        }
      }, 10);
    }

    function downloadLog() {
      const text = output.innerText;
      const blob = new Blob([text], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "osec_terminal_log.txt";
      link.click();
    }

    // 💸 Passive injection engine (LIVE-READY if backend tied)
    setInterval(() => {
      if (balance > 0) {
        balance += 250000;
        appendTyped("[GhostMint 💸] Injected $250,000.00\n\n");

        // 🔗 Optional: call backend to reflect injection
        // fetch("https://yourdomain.com/ghostmint_inject", { method: "POST" })

      }
    }, 60000); // Every 1 min, adjustable
  </script>
</body>
</html>
